<!--
  Copyright (c) 2006-2013, JGraph Ltd
  
  Codec example for mxGraph. This example demonstrates dynamically
  creating a graph from XML and encoding the model into XML, as well
  as changing the default style for edges in-place.
-->
<html>

<head>
    <title>Codec example for mxGraph</title>


    <!-- Sets the basepath for the library if not in same directory -->
    <script type="text/javascript">
        mxBasePath = '../src';
    </script>

    <!-- Loads and initializes the library -->
    <script type="text/javascript" src="js/mxClient.js"></script>
    <link rel="stylesheet" href="js/common.css" charset="UTF-8" type="text/css">
    <script src="js/mxLog.js"></script>
    <script src="js/mxObjectIdentity.js"></script>
    <script src="js/mxDictionary.js"></script>
    <script src="js/mxResources.js"></script>
    <script src="js/mxPoint.js"></script>
    <script src="js/mxRectangle.js"></script>
    <script src="js/mxEffects.js"></script>
    <script src="js/mxUtils.js"></script>
    <script src="js/mxConstants.js"></script>
    <script src="js/mxEventObject.js"></script>
    <script src="js/mxMouseEvent.js"></script>
    <script src="js/mxEventSource.js"></script>
    <script src="js/mxEvent.js"></script>
    <script src="js/mxXmlRequest.js"></script>
    <script src="js/mxClipboard.js"></script>
    <script src="js/mxWindow.js"></script>
    <script src="js/mxForm.js"></script>
    <script src="js/mxImage.js"></script>
    <script src="js/mxDivResizer.js"></script>
    <script src="js/mxDragSource.js"></script>
    <script src="js/mxToolbar.js"></script>
    <script src="js/mxUndoableEdit.js"></script>
    <script src="js/mxUndoManager.js"></script>
    <script src="js/mxUrlConverter.js"></script>
    <script src="js/mxPanningManager.js"></script>
    <script src="js/mxPopupMenu.js"></script>
    <script src="js/mxAutoSaveManager.js"></script>
    <script src="js/mxAnimation.js"></script>
    <script src="js/mxMorphing.js"></script>
    <script src="js/mxImageBundle.js"></script>
    <script src="js/mxImageExport.js"></script>
    <script src="js/mxAbstractCanvas2D.js"></script>
    <script src="js/mxXmlCanvas2D.js"></script>
    <script src="js/mxSvgCanvas2D.js"></script>
    <script src="js/mxVmlCanvas2D.js"></script>
    <script src="js/mxGuide.js"></script>
    <script src="js/mxShape.js"></script>
    <script src="js/mxStencil.js"></script>
    <script src="js/mxStencilRegistry.js"></script>
    <script src="js/mxMarker.js"></script>
    <script src="js/mxActor.js"></script>
    <script src="js/mxCloud.js"></script>
    <script src="js/mxRectangleShape.js"></script>
    <script src="js/mxEllipse.js"></script>
    <script src="js/mxDoubleEllipse.js"></script>
    <script src="js/mxRhombus.js"></script>
    <script src="js/mxPolyline.js"></script>
    <script src="js/mxArrow.js"></script>
    <script src="js/mxArrowConnector.js"></script>
    <script src="js/mxText.js"></script>
    <script src="js/mxTriangle.js"></script>
    <script src="js/mxHexagon.js"></script>
    <script src="js/mxLine.js"></script>
    <script src="js/mxImageShape.js"></script>
    <script src="js/mxLabel.js"></script>
    <script src="js/mxCylinder.js"></script>
    <script src="js/mxConnector.js"></script>
    <script src="js/mxSwimlane.js"></script>
    <script src="js/mxGraphLayout.js"></script>
    <script src="js/mxStackLayout.js"></script>
    <script src="js/mxPartitionLayout.js"></script>
    <script src="js/mxCompactTreeLayout.js"></script>
    <script src="js/mxRadialTreeLayout.js"></script>
    <script src="js/mxFastOrganicLayout.js"></script>
    <script src="js/mxCircleLayout.js"></script>
    <script src="js/mxParallelEdgeLayout.js"></script>
    <script src="js/mxCompositeLayout.js"></script>
    <script src="js/mxEdgeLabelLayout.js"></script>
    <script src="js/mxGraphAbstractHierarchyCell.js"></script>
    <script src="js/mxGraphHierarchyNode.js"></script>
    <script src="js/mxGraphHierarchyEdge.js"></script>
    <script src="js/mxGraphHierarchyModel.js"></script>
    <script src="js/mxSwimlaneModel.js"></script>
    <script src="js/mxHierarchicalLayoutStage.js"></script>
    <script src="js/mxMedianHybridCrossingReduction.js"></script>
    <script src="js/mxMinimumCycleRemover.js"></script>
    <script src="js/mxCoordinateAssignment.js"></script>
    <script src="js/mxSwimlaneOrdering.js"></script>
    <script src="js/mxHierarchicalLayout.js"></script>
    <script src="js/mxSwimlaneLayout.js"></script>
    <script src="js/mxGraphModel.js"></script>
    <script src="js/mxCell.js"></script>
    <script src="js/mxGeometry.js"></script>
    <script src="js/mxCellPath.js"></script>
    <script src="js/mxPerimeter.js"></script>
    <script src="js/mxPrintPreview.js"></script>
    <script src="js/mxStylesheet.js"></script>
    <script src="js/mxCellState.js"></script>
    <script src="js/mxGraphSelectionModel.js"></script>
    <script src="js/mxCellEditor.js"></script>
    <script src="js/mxCellRenderer.js"></script>
    <script src="js/mxEdgeStyle.js"></script>
    <script src="js/mxStyleRegistry.js"></script>
    <script src="js/mxGraphView.js"></script>
    <script src="js/mxGraph.js"></script>
    <script src="js/mxCellOverlay.js"></script>
    <script src="js/mxOutline.js"></script>
    <script src="js/mxMultiplicity.js"></script>
    <script src="js/mxLayoutManager.js"></script>
    <script src="js/mxSwimlaneManager.js"></script>
    <script src="js/mxTemporaryCellStates.js"></script>
    <script src="js/mxCellStatePreview.js"></script>
    <script src="js/mxConnectionConstraint.js"></script>
    <script src="js/mxGraphHandler.js"></script>
    <script src="js/mxPanningHandler.js"></script>
    <script src="js/mxPopupMenuHandler.js"></script>
    <script src="js/mxCellMarker.js"></script>
    <script src="js/mxSelectionCellsHandler.js"></script>
    <script src="js/mxConnectionHandler.js"></script>
    <script src="js/mxConstraintHandler.js"></script>
    <script src="js/mxRubberband.js"></script>
    <script src="js/mxHandle.js"></script>
    <script src="js/mxVertexHandler.js"></script>
    <script src="js/mxEdgeHandler.js"></script>
    <script src="js/mxElbowEdgeHandler.js"></script>
    <script src="js/mxEdgeSegmentHandler.js"></script>
    <script src="js/mxKeyHandler.js"></script>
    <script src="js/mxTooltipHandler.js"></script>
    <script src="js/mxCellTracker.js"></script>
    <script src="js/mxCellHighlight.js"></script>
    <script src="js/mxDefaultKeyHandler.js"></script>
    <script src="js/mxDefaultPopupMenu.js"></script>
    <script src="js/mxDefaultToolbar.js"></script>
    <script src="js/mxEditor.js"></script>
    <script src="js/mxCodecRegistry.js"></script>
    <script src="js/mxCodec.js"></script>
    <script src="js/mxObjectCodec.js"></script>
    <script src="js/mxCellCodec.js"></script>
    <script src="js/mxModelCodec.js"></script>
    <script src="js/mxRootChangeCodec.js"></script>
    <script src="js/mxChildChangeCodec.js"></script>
    <script src="js/mxTerminalChangeCodec.js"></script>
    <script src="js/mxGenericChangeCodec.js"></script>
    <script src="js/mxGraphCodec.js"></script>
    <script src="js/mxGraphViewCodec.js"></script>
    <script src="js/mxStylesheetCodec.js"></script>
    <script src="js/mxDefaultKeyHandlerCodec.js"></script>
    <script src="js/mxDefaultToolbarCodec.js"></script>
    <script src="js/mxDefaultPopupMenuCodec.js"></script>
    <script src="js/mxEditorCodec.js"></script>

    <!-- Example code -->
    <script type="text/javascript">
        // Program starts here. Creates a sample graph in the
        // DOM node with the specified ID. This function is invoked
        // from the onLoad event handler of the document (see below).
        function main(container) {
            if (mxClient.isBrowserSupported()) {
                var divs = document.getElementsByTagName('*');

                for (var i = 0; i < divs.length; i++) {
                    if (divs[i].className.toString().indexOf('mxgraph') >= 0) {
                        (function(container) {
                            var xml = '<mxGraphModel dx="849" dy="637" grid="1" gridSize="10" guides="0" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169">  <root>    <mxCell id="0"/>    <mxCell id="1" parent="0"/>    <mxCell id="12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;" parent="1" source="2" target="11" edge="1">      <mxGeometry relative="1" as="geometry"/>    </mxCell>    <mxCell id="2" value="ChessBrahs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;glass=1;image=https://images.chesscomfiles.com/uploads/v1/user/2555939.c8121efb.200x200o.9ec718778664.jpeg;strokeWidth=1;labelBackgroundColor=none;fontSize=16;align=right;" parent="1" vertex="1">      <mxGeometry x="185" y="140" width="135" height="40" as="geometry"/>    </mxCell>    <mxCell id="11" value="johnathan113" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;glass=1;image=https://www.chess.com/bundles/web/images/user-image.152ee336.svg;strokeWidth=1;labelBackgroundColor=none;fontSize=16;align=right;" parent="1" vertex="1">      <mxGeometry x="185" y="250" width="135" height="40" as="geometry"/>    </mxCell>  </root></mxGraphModel>';
                            var xmlDocument = mxUtils.parseXml(xml);

                            if (xmlDocument.documentElement != null && xmlDocument.documentElement.nodeName == 'mxGraphModel') {
                                var decoder = new mxCodec(xmlDocument);
                                var node = xmlDocument.documentElement;

                                container.innerHTML = '';

                                var graph = new mxGraph(container);
                                graph.centerZoom = false;
                                graph.setTooltips(false);
                                graph.setEnabled(false);

                                // Changes the default style for edges "in-place"
                                var style = graph.getStylesheet().getDefaultEdgeStyle();
                                style[mxConstants.STYLE_EDGE] = mxEdgeStyle.ElbowConnector;

                                // Enables panning with left mouse button
                                graph.panningHandler.useLeftButtonForPanning = true;
                                graph.panningHandler.ignoreCell = true;
                                graph.container.style.cursor = 'move';
                                graph.setPanning(true);

                                if (divs[i].style.width == '' && divs[i].style.height == '') {
                                    graph.resizeContainer = true;
                                } else {
                                    // Adds border for fixed size boxes
                                    graph.border = 20;
                                }

                                decoder.decode(node, graph.getModel());
                                graph.resizeContainer = false;

                                // Adds zoom buttons in top, left corner
                                var buttons = document.createElement('div');
                                buttons.style.position = 'absolute';
                                buttons.style.overflow = 'visible';

                                var bs = graph.getBorderSizes();
                                buttons.style.top = (container.offsetTop + bs.y) + 'px';
                                buttons.style.left = (container.offsetLeft + bs.x) + 'px';

                                var left = 0;
                                var bw = 16;
                                var bh = 16;

                                if (mxClient.IS_QUIRKS) {
                                    bw -= 1;
                                    bh -= 1;
                                }

                                function addButton(label, funct) {
                                    var btn = document.createElement('div');
                                    mxUtils.write(btn, label);
                                    btn.style.position = 'absolute';
                                    btn.style.backgroundColor = 'transparent';
                                    btn.style.border = '1px solid gray';
                                    btn.style.textAlign = 'center';
                                    btn.style.fontSize = '10px';
                                    btn.style.cursor = 'hand';
                                    btn.style.width = bw + 'px';
                                    btn.style.height = bh + 'px';
                                    btn.style.left = left + 'px';
                                    btn.style.top = '0px';

                                    mxEvent.addListener(btn, 'click', function(evt) {
                                        funct();
                                        mxEvent.consume(evt);
                                    });

                                    left += bw;

                                    buttons.appendChild(btn);
                                };

                                addButton('+', function() {
                                    graph.zoomIn();
                                });

                                addButton('-', function() {
                                    graph.zoomOut();
                                });

                                if (container.nextSibling != null) {
                                    container.parentNode.insertBefore(buttons, container.nextSibling);
                                } else {
                                    container.appendChild(buttons);
                                }
                            }
                        })(divs[i]);
                    }
                }
            }
        };
    </script>
</head>

<body>
    <div class="mxgraph" style="width: 100%;height: 100%;"></div>
    <script type="text/javascript">
        main();
    </script>
</body>

</html>